<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8" />
    <title>Apartman YÃ¶netim Paneli</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="stylesheet" href="style.css" />

    <!-- PDF iÃ§in jsPDF -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.8.2/jspdf.plugin.autotable.min.js"></script>

    <!-- Excel iÃ§in SheetJS -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
</head>
<body>
    <div class="app">
        <header class="app-header">
            <div>
                <h1>Apartman YÃ¶netim Paneli</h1>
                <p class="subtitle">Aidat, gelirâ€“gider takibi, rapor ve Excel Ã§Ä±ktÄ±sÄ±</p>
            </div>
            <div class="header-right">
                <label class="month-label">
                    Ay SeÃ§:
                    <input type="month" id="monthSelect" />
                </label>
            </div>
        </header>

        <section class="toolbar">
            <button id="btnAddResident" class="btn primary">Yeni Daire / KullanÄ±cÄ±</button>
            <button id="btnExportPDF" class="btn">PDF Rapor</button>
            <button id="btnExportExcel" class="btn">Excel Ã‡Ä±ktÄ±sÄ±</button>
            <button id="btnClearData" class="btn danger outline">TÃ¼m Veriyi Sil</button>
        </section>

        <section class="content">
            <!-- DAÄ°RELER TABLOSU -->
            <div class="table-card">
                <div class="table-header">
                    <h2>Aidat Listesi</h2>
                    <div class="summary">
                        <span>Toplam AylÄ±k Aidat: <strong id="summaryMonthlyFee">0</strong> â‚º</span>
                        <span>Bu Ay Ã–denen: <strong id="summaryPaid">0</strong> â‚º</span>
                        <span>Kalan: <strong id="summaryRemaining">0</strong> â‚º</span>
                    </div>
                </div>
                <div class="table-wrapper">
                    <table id="residentTable">
                        <thead>
                            <tr>
                                <th>Daire No</th>
                                <th>Ä°sim / Soyisim</th>
                                <th>AylÄ±k Aidat (â‚º)</th>
                                <th>Bu Ay Ã–denen (â‚º)</th>
                                <th>Kalan BorÃ§ (â‚º)</th>
                                <th>Not</th>
                                <th>Ä°ÅŸlemler</th>
                            </tr>
                        </thead>
                        <tbody id="residentTableBody"></tbody>
                    </table>
                </div>
                <p class="hint">
                    Veriler tarayÄ±cÄ±daki <strong>localStorage</strong>'da saklanÄ±r.
                </p>
            </div>

            <!-- GELÄ°R â€“ GÄ°DER KARTI -->
            <div class="table-card finance-card">
                <!-- YIL GENELÄ° Ã–ZET PANELÄ° -->
<div class="table-card" id="yearSummaryCard">
    <div class="table-header">
        <h2>YÄ±l Genel Ã–zeti</h2>
        <label>
            YÄ±l SeÃ§:
            <select id="yearSelect"></select>
        </label>
    </div>

    <div class="summary">
        <span>YÄ±llÄ±k Toplam Gelir: <strong id="yearIncome">0</strong> â‚º</span>
        <span>YÄ±llÄ±k Toplam Gider: <strong id="yearExpense">0</strong> â‚º</span>
        <span>Net Kasa: <strong id="yearNet">0</strong> â‚º</span>
    </div>

    <div class="table-wrapper">
        <table>
            <thead>
                <tr>
                    <th>Ay</th>
                    <th>Aidat Geliri (â‚º)</th>
                    <th>Gider (â‚º)</th>
                    <th>Net (â‚º)</th>
                </tr>
            </thead>
            <tbody id="yearSummaryTableBody"></tbody>
        </table>
    </div>
</div>

                <div class="table-header">
                    <h2>Gelir &amp; Gider Ã–zeti</h2>
                    <div class="summary">
                        <span>Bu Ay Toplam Gelir: <strong id="summaryIncome">0</strong> â‚º</span>
                        <span>Bu Ay Toplam Gider: <strong id="summaryExpense">0</strong> â‚º</span>
                        <span class="net-wrapper">Net Kasa: <strong id="summaryNet">0</strong> â‚º</span>
                    </div>
                </div>

                <div class="finance-toolbar">
                    <button id="btnAddExpense" class="btn">Gider Ekle</button>
                </div>

                <div class="table-wrapper">
                    <table>
                        <thead>
                            <tr>
                                <th>Tarih</th>
                                <th>Kategori</th>
                                <th>AÃ§Ä±klama</th>
                                <th>Tutar (â‚º)</th>
                                <th>Ä°ÅŸlemler</th>
                            </tr>
                        </thead>
                        <tbody id="expenseTableBody"></tbody>
                    </table>
                </div>
            </div>
        </section>
    </div>

    <!-- KullanÄ±cÄ± ekleme / dÃ¼zenleme modal -->
    <div class="modal-backdrop" id="residentModal">
        <div class="modal">
            <div class="modal-header">
                <h2 id="residentModalTitle">Yeni KullanÄ±cÄ± / Daire</h2>
                <button id="modalCloseBtn" class="icon-btn">âœ•</button>
            </div>
            <form id="residentForm" class="modal-body">
                <input type="hidden" id="residentId" />

                <label>Daire No
                    <input type="text" id="flatNo" required>
                </label>
                <label>Ä°sim Soyisim
                    <input type="text" id="fullName" required>
                </label>
                <label>AylÄ±k Aidat
                    <input type="number" id="monthlyFee" required min="0" step="0.01">
                </label>
                <label>Bu Ay Ã–denen
                    <input type="number" id="paidThisMonth" value="0" min="0" step="0.01">
                </label>
                <label>Not
                    <textarea id="note"></textarea>
                </label>

                <button type="submit" class="btn primary">Kaydet</button>
            </form>
        </div>
    </div>

    <!-- GÄ°DER MODALI -->
    <div class="modal-backdrop" id="expenseModal">
        <div class="modal">
            <div class="modal-header">
                <h2 id="expenseModalTitle">Yeni Gider</h2>
                <button id="expenseModalCloseBtn" class="icon-btn">âœ•</button>
            </div>
            <form id="expenseForm" class="modal-body">
                <input type="hidden" id="expenseId" />

                <label>Tarih
                    <input type="date" id="expenseDate" required>
                </label>
                <label>Kategori
                    <input type="text" id="expenseCategory" placeholder="Ã–rn: Elektrik, Temizlik">
                </label>
                <label>AÃ§Ä±klama
                    <input type="text" id="expenseDescription">
                </label>
                <label>Tutar (â‚º)
                    <input type="number" id="expenseAmount" required min="0" step="0.01">
                </label>

                <button type="submit" class="btn primary">Kaydet</button>
            </form>
        </div>
    </div>

    <!-- Ã–DEME GEÃ‡MÄ°ÅžÄ° MODALI -->
    <div class="modal-backdrop" id="historyModal">
        <div class="modal">
            <div class="modal-header">
                <h2 id="historyModalTitle">Ã–deme GeÃ§miÅŸi</h2>
                <button id="historyModalCloseBtn" class="icon-btn">âœ•</button>
            </div>
            <div class="modal-body">
                <div class="table-wrapper">
                    <table>
                        <thead>
                            <tr>
                                <th>Ay</th>
                                <th>Aidat (â‚º)</th>
                                <th>Ã–denen (â‚º)</th>
                                <th>Kalan (â‚º)</th>
                            </tr>
                        </thead>
                        <tbody id="historyList"></tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- GÄ°RÄ°Åž EKRANI -->
    <div id="loginScreen" class="login-screen">
        <div class="login-box">
            <h2>Apartman YÃ¶netimi GiriÅŸ</h2>

            <label>KullanÄ±cÄ± AdÄ±</label>
            <input type="text" id="loginUsername">

            <label>Åžifre</label>
            <input type="password" id="loginPassword">

            <button id="loginBtn" class="btn primary">GiriÅŸ Yap</button>

            <p id="loginError" class="error-text"></p>
            <p class="hint small">
                YÃ¶netici: <strong>yonetici / 6161</strong><br>
                DenetÃ§i: <strong>denetci / 1234</strong>
            </p>
        </div>
    </div>

    <script src="app.js"></script>
</body>
</html>
<!-- YIL GENELÄ° Ã–ZETÄ° (AÃ‡ILIR KAPANIR PANEL) -->
<div class="accordion">
    <button class="accordion-header" id="toggleYearSummary">
        <span>ðŸ“˜ YÄ±l Genel Ã–zeti</span>
        <span class="arrow">â–¼</span>
    </button>

    <div class="accordion-body" id="yearSummaryPanel">
        <div class="table-card" id="yearSummaryCard">
            <div class="table-header">
                <h2>YÄ±l Genel Ã–zeti</h2>
                <label>
                    YÄ±l SeÃ§:
                    <select id="yearSelect"></select>
                </label>
            </div>

            <div class="summary">
                <span>YÄ±llÄ±k Toplam Gelir: <strong id="yearIncome">0</strong> â‚º</span>
                <span>YÄ±llÄ±k Toplam Gider: <strong id="yearExpense">0</strong> â‚º</span>
                <span>Net Kasa: <strong id="yearNet">0</strong> â‚º</span>
            </div>

            <div class="table-wrapper">
                <table>
                    <thead>
                        <tr>
                            <th>Ay</th>
                            <th>Aidat Geliri (â‚º)</th>
                            <th>Gider (â‚º)</th>
                            <th>Net (â‚º)</th>
                        </tr>
                    </thead>
                    <tbody id="yearSummaryTableBody"></tbody>
                </table>
            </div>
        </div>
    </div>
</div>
